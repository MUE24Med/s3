<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <title>semester-3 | Ø®Ø±ÙŠØ·Ø© Ø§Ù„ÙƒÙ„ÙŠØ© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</title>

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://mue24med.github.io/semester-3/">
  <meta property="og:title" content="semester-3 | Ø®Ø±ÙŠØ·Ø© Ø§Ù„ÙƒÙ„ÙŠØ© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©">
  <meta property="og:description" content="Ø®Ø±ÙŠØ·Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ø¹Ø±Ø¶ Ù…Ø­Ø§Ø¶Ø±Ø§Øª ÙˆØ³ÙƒØ§Ø´Ù† Ø§Ù„ÙØ±Ù‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© - Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù„Ø«">
  <meta property="og:image" content="https://mue24med.github.io/semester-3/image/0.webp">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:locale" content="ar_AR">

  <!-- PWA / Mobile -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="theme-color" content="#000000">
  <meta name="color-scheme" content="only light">

  <!-- Cache Control -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta name="version" content="2025.02.12.FINAL">

  <!-- Performance -->
  <link rel="preconnect" href="https://raw.githubusercontent.com" crossorigin>
  <link rel="preconnect" href="https://api.github.com" crossorigin>
  <link rel="dns-prefetch" href="https://mozilla.github.io">

  <!-- Icons -->
  <link rel="icon" type="image/png" href="image/0.png">
  <link rel="apple-touch-icon" href="image/0.png">

  <!-- Styles -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- ================ Ø¬Ù…ÙŠØ¹ Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±) ================ -->
  <!-- Ø´Ø§Ø´Ø© Ø§Ø®ØªÙŠØ§Ø± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ÙØªØ­ØŒ Ø´Ø§Ø´Ø© PreloadØŒ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§ØªØŒ Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø¯ÙˆØ§ØªØŒ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ØŒ Ø¹Ø§Ø±Ø¶ PDFØŒ Ù…Ø¹Ø§ÙŠÙ†Ø© PDFØŒ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© -->
  <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙƒÙ…Ø§ Ù‡Ùˆ Ø¯ÙˆÙ† Ø­Ø°Ù Ø£Ùˆ ØªØ¹Ø¯ÙŠÙ„ â€“ ÙŠÙÙ†Ø³Ø® Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ù† Ù…Ù„ÙÙƒ Ø§Ù„Ø£ØµÙ„ÙŠ -->

  <!-- ================ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© ================ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    if (typeof pdfjsLib !== 'undefined') {
      pdfjsLib.GlobalWorkerOptions.workerSrc = 
        'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    }
  </script>

  <!-- âœ… Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ â€“ Ù†Ù‚Ø·Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙˆØ­ÙŠØ¯Ø© (ÙÙŠ Ø§Ù„Ø¬Ø°Ø±) -->
  <script src="script.js"></script>

  <!-- âœ… Tracker â€“ ØºÙŠØ± Ù…Ø¹ÙŠØ§Ø±ÙŠØŒ ÙŠÙØ­Ù…Ù‘Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© -->
  <script src="tracker.js"></script>

  <!-- âœ… Service Worker ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(registration => {
            console.log('âœ… Service Worker Ù…Ø³Ø¬Ù„');

            registration.addEventListener('updatefound', () => {
              const newWorker = registration.installing;
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  if (confirm('ğŸ”„ ÙŠÙˆØ¬Ø¯ ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ØŸ')) {
                    newWorker.postMessage({ action: 'skipWaiting' });
                    window.location.reload();
                  }
                }
              });
            });
          })
          .catch(err => console.error('âŒ ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ SW:', err));
      });

      let refreshing = false;
      navigator.serviceWorker.addEventListener('controllerchange', () => {
        if (!refreshing) {
          refreshing = true;
          window.location.reload();
        }
      });
    }
  </script>

  <!-- âœ… ÙØ­Øµ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ù…Ù† GitHub -->
  <script>
    async function checkForUpdates() {
      try {
        const lastCheck = localStorage.getItem('last_update_check');
        const now = Date.now();

        if (lastCheck && (now - parseInt(lastCheck)) < 300000) return;

        const response = await fetch(
          'https://api.github.com/repos/MUE24Med/s3/commits/main',
          { 
            cache: 'no-store', 
            headers: { 'Accept': 'application/vnd.github.v3+json' } 
          }
        );

        if (!response.ok) return;

        const data = await response.json();
        const latestSha = data.sha.substring(0, 7);
        const lastSha = localStorage.getItem('last_commit_sha');

        if (!lastSha) {
          localStorage.setItem('last_commit_sha', latestSha);
          localStorage.setItem('last_update_check', now.toString());
          return;
        }

        if (lastSha !== latestSha) {
          console.log('ğŸ†• ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯ Ù…ØªØ§Ø­:', latestSha);

          const cacheNames = await caches.keys();
          await Promise.all(cacheNames.map(name => caches.delete(name)));

          localStorage.setItem('last_commit_sha', latestSha);
          localStorage.removeItem('preload_done');

          window.location.reload(true);
        } else {
          localStorage.setItem('last_update_check', now.toString());
        }
      } catch (error) {
        console.warn('âš ï¸ Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª:', error);
      }
    }

    window.addEventListener('load', checkForUpdates);
    document.addEventListener('visibilitychange', () => {
      if (!document.hidden) checkForUpdates();
    });
  </script>

</body>
</html>