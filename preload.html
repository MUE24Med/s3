<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Mini Loading Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Arial, sans-serif;
  overflow:hidden;
}

/* ===== Ø§Ù„Ù„Ø¹Ø¨Ø© ===== */
#game{
  position:relative;
  width:360px;
  height:520px;
  margin:20px auto;
  background:#111;
  border:3px solid #555;
  overflow:hidden;
}

/* Ø§Ù„Ù„Ø§Ø¹Ø¨ */
#player{
  position:absolute;
  bottom:15px;
  font-size:34px;
  transform:translateX(-50%);
}

/* Ø§Ù„Ø¹Ù†Ø§ØµØ± */
.item{
  position:absolute;
  font-size:28px;
}

/* Ø§Ù„Ù‚Ù„ÙˆØ¨ */
#hearts{
  text-align:center;
  margin-bottom:6px;
  font-size:20px;
}

/* Ø§Ù„ØªØ­ÙƒÙ… */
#controls{
  width:360px;
  margin:10px auto;
  display:flex;
  justify-content:space-between;
}

button{
  font-size:22px;
  padding:10px 22px;
  cursor:pointer;
}

/* Game Over */
#gameover{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.85);
  display:none;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  font-size:24px;
}

#restart{
  margin-top:15px;
  font-size:26px;
  cursor:pointer;
}
</style>
</head>

<body>

<div id="hearts"></div>

<div id="game">
  <div id="player">ğŸ‘¨â€âš•ï¸</div>

  <div id="gameover">
    <div>ğŸ’€ Game Over</div>
    <div id="restart">ğŸ”„</div>
  </div>
</div>

<div id="controls">
  <!-- Ø´Ù…Ø§Ù„ Ø§Ù„Ø´Ø§Ø´Ø© Ù„ÙƒÙ† ÙŠÙ…ÙŠÙ† ÙØ¹Ù„ÙŠÙ‹Ø§ -->
  <button onclick="moveRight()">â¡ï¸</button>

  <!-- ÙŠÙ…ÙŠÙ† Ø§Ù„Ø´Ø§Ø´Ø© Ù„ÙƒÙ† Ø´Ù…Ø§Ù„ ÙØ¹Ù„ÙŠÙ‹Ø§ -->
  <button onclick="moveLeft()">â¬…ï¸</button>
</div>

<script>
/* ===== Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ===== */
const game   = document.getElementById("game");
const player = document.getElementById("player");
const heartsEl = document.getElementById("hearts");
const overEl = document.getElementById("gameover");
const restartBtn = document.getElementById("restart");

const lanes = [90, 180, 270]; // 3 Ø­Ø§Ø±Ø§Øª
let laneIndex;
let hearts;
let running;

/* ===== ØªÙ‡ÙŠØ¦Ø© ===== */
function resetGame(){
  document.querySelectorAll(".item").forEach(e=>e.remove());
  laneIndex = 1;
  hearts = 0;
  running = true;
  overEl.style.display = "none";
  updatePlayer();
  updateHearts();
  startWaves();
}

function updatePlayer(){
  player.style.left = lanes[laneIndex] + "px";
}

function updateHearts(){
  heartsEl.textContent = "â¤ï¸".repeat(hearts);
}

/* ===== Ø§Ù„Ø­Ø±ÙƒØ© (Ù…Ø¹ÙƒÙˆØ³Ø©) ===== */
function moveLeft(){
  if(laneIndex < 2){
    laneIndex++;
    updatePlayer();
  }
}

function moveRight(){
  if(laneIndex > 0){
    laneIndex--;
    updatePlayer();
  }
}

/* ===== ÙƒÙŠØ¨ÙˆØ±Ø¯ Ù…Ø¹ÙƒÙˆØ³ ===== */
document.addEventListener("keydown", e=>{
  if(e.key==="ArrowLeft") moveRight();
  if(e.key==="ArrowRight") moveLeft();
});

/* ===== Ø§Ù„Ø¹Ù†Ø§ØµØ± ===== */
function spawnItem(){
  if(!running) return;

  const el = document.createElement("div");
  el.className="item";

  const r = Math.random();
  if(r < 0.4) el.textContent="â˜£ï¸";     // ÙÙŠØ±ÙˆØ³ Ù‚ÙˆÙŠ
  else if(r < 0.7) el.textContent="ğŸ¦ "; // ÙÙŠØ±ÙˆØ³
  else el.textContent="ğŸ’Š";             // Ø¹Ù„Ø§Ø¬

  const lane = Math.floor(Math.random()*3);
  el.dataset.lane = lane;
  el.style.left = lanes[lane]+"px";
  el.style.top="0px";
  game.appendChild(el);

  let y=0;
  let midSpawn=false;

  function fall(){
    if(!running){ el.remove(); return; }

    y+=3;
    el.style.top=y+"px";

    // Ø§ØµØ·Ø¯Ø§Ù…
    if(y > game.clientHeight-80 && laneIndex == lane){
      handleHit(el.textContent);
      el.remove();
      return;
    }

    // Ø¹Ù†Ø¯ Ù†Øµ Ø§Ù„Ù…Ø³Ø§ÙØ© ÙŠÙ†Ø²Ù„ Ø§ØªÙ†ÙŠÙ† ÙÙ‚Ø·
    if(y > game.clientHeight/2 && !midSpawn){
      midSpawn=true;
      spawnItem();
      spawnItem();
    }

    if(y < game.clientHeight){
      requestAnimationFrame(fall);
    }else{
      el.remove();
    }
  }
  fall();
}

/* ===== Ø§Ù„ØªØµØ§Ø¯Ù… ===== */
function handleHit(type){
  if(type==="â˜£ï¸") hearts -= 2;
  if(type==="ğŸ¦ ") hearts -= 1;
  if(type==="ğŸ’Š") hearts += 1;

  if(hearts < 0) hearts = 0;
  updateHearts();

  if(hearts === 0){
    gameOver();
  }
}

/* ===== Game Over ===== */
function gameOver(){
  running=false;
  overEl.style.display="flex";
}

/* ===== Ø§Ù„Ù…ÙˆØ¬Ø§Øª ===== */
function startWaves(){
  spawnItem();
  spawnItem();

  const interval = setInterval(()=>{
    if(!running){
      clearInterval(interval);
      return;
    }
    spawnItem();
    spawnItem();
  },2000);
}

/* ===== Ø¥Ø¹Ø§Ø¯Ø© ===== */
restartBtn.onclick = resetGame;

/* ===== ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ Ù…Ø±Ø© ===== */
resetGame();
</script>

</body>
</html>